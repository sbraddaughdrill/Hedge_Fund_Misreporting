#controls3 <- "age_y + AUM + total_fee + Domicile_onshore_bin + Flagship_bin + Lockup_bin + Leverage_bin"
#controls3 <- "age_y + AUM + Domicile_onshore_bin + Flagship_bin + Lockup_bin + Leverage_bin"
controls3 <- "age_y_log + AUM_USm_log + Lockup_bin + Hurdle_Rate_bin + Domicile_onshore_bin"
#controls3 <- "age_y + AUM + Lockup_bin + Hurdle_Rate_bin + Domicile_onshore_bin"
#controls3 <- "age_y + AUM + Lockup_bin"
model_type3 <- "pooling"
note3 <- "cat_sim"
#sim_type3 <- c("900pct")
#sim_type3 <- c("050pct","900pct")
#sim_type3 <- c("050pct","750pct","900pct")
#sim_type3 <- c("050pct","500pct","750pct","900pct")
sim_type3 <- c("050pct","100pct","250pct","500pct","750pct","900pct")
#read3 <- "avg_grade_level_XXX"
#read3 <- "FOG_XXX"
#read3 <- "Coleman_Liau_XXX"
read3 <- "words_ios"
strat3 <- "Primary_Investment_Strategy_combcol_similarity_YYYpct_XXX"
regression_equations3 <- data.frame(grade=NA,similarity=NA,controls=NA,quantile=NA,fixed_effects=NA,full_independent_vars=NA,stringsAsFactors=F)
regression_equations3[1,] <- c(read3,NA,NA,NA,NA,NA)
regression_equations3[2,] <- c(strat3,NA,NA,NA,NA,NA)
regression_equations3[3,] <- c(paste(read3,strat3,sep=" + "),NA,NA,NA,NA,NA)
regression_equations3[4,] <- c(read3,NA,controls3,NA,NA,NA)
regression_equations3[5,] <- c(strat3,NA,controls3,NA,NA,NA)
regression_equations3[6,] <- c(paste(read3,strat3,sep=" + "),NA,controls3,NA,NA,NA)
regression_equations3[7,] <- c(read3,NA,controls3,NA,strat_dvs,NA)
regression_equations3[8,] <- c(strat3,NA,controls3,NA,strat_dvs,NA)
regression_equations3[9,] <- c(paste(read3,strat3,sep=" + "),NA,controls3,NA,strat_dvs,NA)
for (i in 1:ncol(regression_equations3))
{
#regression_equations3[i,] <-  gsub("PCT","90",regression_equations3[i,])
#regression_equations3[i,] <-  gsub("ANYAVG","any",regression_equations3[i,])
#regression_equations3[i,] <-  gsub("CUTOFF","024",regression_equations3[i,])
regression_equations3[i,] <-  unknown_to_NA(regression_equations3[i,],unknowns_strings)
}
for (i in 1:nrow(regression_equations3))
{
temp_char_vec <- c(na.omit(as.character(unlist(regression_equations3[i,1:(ncol(regression_equations3)-1)],use.names=F))))
regression_equations3[i,"full_independent_vars"] <- paste(temp_char_vec,sep="",collapse=" + ")
}
for (k in 1:nrow(data_year_groups3))
{
# k <- 1
cat("START YEAR:",data_year_groups3[k,1],"END YEAR:",data_year_groups3[k,2],"\n")
#data_temp <- data_all[(data_all[,"yr"]>=data_year_groups3[k,1] & data_all[,"yr"]<=data_year_groups3[k,2]),]
data_temp <- data_reg[(data_reg[,"yr"]>=data_year_groups3[k,1] & data_reg[,"yr"]<=data_year_groups3[k,2]),]
data_temp.pd <- pdata.frame(data_temp,index=c(identifier,"yr"),drop.index=T,row.names=T)
for (i in 1:length(dep_var3))
{
# i <- 1
for (j in 1:length(sim_type3))
{
# j <- 1
# j <- 2
out_file_name <- paste("reg_compare_plm",dep_var3[i],data_year_groups3[k,1],data_year_groups3[k,2],note3,sim_type3[j],sep="_")
#models <- rep( list(list()),nrow(regression_equations3) )
se <- rep(list(list()),nrow(regression_equations3))
pval <- rep(list(list()),nrow(regression_equations3))
for (l in 1:nrow(regression_equations3))
{
#l <- 1
ind_vars_reg0 <- regression_equations3[l,"full_independent_vars"]
ind_vars_reg0 <- gsub("XXX","ios",ind_vars_reg0,ignore.case=T)
ind_vars_reg0 <- gsub("YYYpct",sim_type3[j],ind_vars_reg0,ignore.case=T)
reg0 <- lm(as.formula(paste(dep_var3[i],ind_vars_reg0,sep="~")),data_temp)
reg0_rse <- coeftest(reg0)
#reg0_rse <- coeftest(reg0,vcov=function(x) vcovHC(x,cluster="group",type="HC1"))
#reg0_rse <- coeftest(reg0,vcov=function(x) vcovDC(x,type="HC1"))
#reg0 <- plm(as.formula(paste(dep_var3[i],ind_vars_reg0,sep="~")),data=data_temp.pd,model=model_type3)
#reg0_rse <- cl.plm(data_temp,reg0,data_temp[,identifier])
#reg0_rse <- mcl.plm(data_temp,reg0,data_temp[,identifier],data_temp[,"yr"])
#reg0_rse <- mcl(data_temp,reg0,data_temp[,identifier],data_temp[,"yr"])
#screenreg(list(reg0),digits=3,model.names=c("(1)"),override.se=list(reg0_rse[,2]),override.pval=list(reg0_rse[,4]),stars=c(0.01,0.05,0.1))
#screenreg(list(reg0),digits=3,model.names=c("(1)"),override.se=list(reg0_rse[,4]),override.pval=list(reg0_rse[,4]),stars=c(0.01,0.05,0.1))
#models[[l]] <- reg0
#se[[l]] <- reg0_rse[,2]
se[[l]] <- reg0_rse[,4]
pval[[l]] <- reg0_rse[,4]
assign(paste("reg",l,sep=""),reg0,envir=.GlobalEnv)
#assign(paste("reg",l,"_rse",sep=""),reg0_rse,envir=.GlobalEnv)
rm2(ind_vars_reg0,reg0,reg0_rse)
}
htmlreg(l=eval(parse(text=paste("list(",paste("reg",seq(1,nrow(regression_equations3)),sep="",collapse=","),")",sep=""))),
model.names=paste("(",seq(1,nrow(regression_equations3)),")",sep=""),override.se=se,override.pval=pval,stars=c(0.01,0.05,0.1),digits=3,
caption="Effect of ???? on Hedge Fund Scores – Multivariate",file=paste(output_dir_reg3,out_file_name,".doc",sep=""))
rm2(se,pval,out_file_name,l)
eval(parse(text=paste("rm(",paste("reg",seq(1,nrow(regression_equations3)),sep="",collapse=","),")",sep="")))
}
rm2(j)
}
rm2(data_temp,data_temp.pd,i)
}
rm2(output_dir_reg3,data_year_groups3,dep_var3,model_type3,note3,sim_type3,controls3,read3,strat3,regression_equations3,temp_char_vec,k)
###############################################################################
cat("REGRESSION - QUALITY SCORE - TONE","\n")
###############################################################################
output_dir_reg5 <- paste(output_directory,"reg_tone_cont","\\",sep="")
create_directory(output_dir_reg5,remove=1)
data_year_groups5 <- data.frame(matrix(NA,ncol=2,nrow=1,dimnames=list(c(),c("Start_yr","End_yr"))),stringsAsFactors=F)
data_year_groups5[1,] <- c(beg_year,end_year)
dep_var5 <- unlist(dep_input_cont[,"dep_var"])
#controls5 <- "age_y + AUM + total_fee + Domicile_onshore_bin + Flagship_bin + Lockup_bin + Leverage_bin + Revision_DV + Sharpe_Ratio "
#controls5 <- "age_y + AUM + total_fee + Domicile_onshore_bin + Flagship_bin + Lockup_bin + Leverage_bin"
#controls5 <- "age_y + AUM + Domicile_onshore_bin + Flagship_bin + Lockup_bin + Leverage_bin"
controls5 <- "age_y_log + AUM_USm_log + Lockup_bin + Hurdle_Rate_bin + Domicile_onshore_bin"
#controls5 <- "age_y + AUM + Lockup_bin + Hurdle_Rate_bin + Domicile_onshore_bin"
#controls5 <- "age_y + AUM + Lockup_bin"
model_type5 <- "pooling"
note5 <- "tone"
#sim_type5 <- c("900pct")
#sim_type5 <- c("050pct","900pct")
#sim_type5 <- c("050pct","750pct","900pct")
#sim_type5 <- c("050pct","500pct","750pct","900pct")
sim_type5 <- c("050pct","100pct","250pct","500pct","750pct","900pct")
regression_equations5 <- data.frame(grade=NA,similarity=NA,controls=NA,quantile=NA,fixed_effects=NA,full_independent_vars=NA,stringsAsFactors=F)
# regression_equations5[1,] <- c("per_litigious",NA,controls5,NA,NA,NA)
# regression_equations5[2,] <- c("per_modalstrong",NA,controls5,NA,NA,NA)
# regression_equations5[3,] <- c("per_modalweak",NA,controls5,NA,NA,NA)
# regression_equations5[4,] <- c("per_negative",NA,controls5,NA,NA,NA)
# regression_equations5[5,] <- c("per_positive",NA,controls5,NA,NA,NA)
# regression_equations5[6,] <- c("per_uncertainty",NA,controls5,NA,NA,NA)
# regression_equations5[7,] <- c("per_litigious + per_modalstrong + per_modalweak + per_negative + per_positive + per_uncertainty",NA,controls5,NA,NA,NA)
# regression_equations5[8,] <- c("per_litigious + per_modalstrong + per_modalweak + per_negative + per_positive + per_uncertainty",NA,controls5,NA,strat_dvs,NA)
regression_equations5[1,] <- c("per_litigious",NA,NA,NA,NA,NA)
regression_equations5[2,] <- c("per_negative",NA,NA,NA,NA,NA)
regression_equations5[3,] <- c("per_positive",NA,NA,NA,NA,NA)
regression_equations5[4,] <- c("per_uncertainty",NA,NA,NA,NA,NA)
regression_equations5[5,] <- c("per_litigious",NA,controls5,NA,NA,NA)
regression_equations5[6,] <- c("per_negative",NA,controls5,NA,NA,NA)
regression_equations5[7,] <- c("per_positive",NA,controls5,NA,NA,NA)
regression_equations5[8,] <- c("per_uncertainty",NA,controls5,NA,NA,NA)
regression_equations5[9,] <- c("per_litigious + per_negative + per_positive + per_uncertainty",NA,controls5,NA,NA,NA)
regression_equations5[10,] <- c("per_litigious + per_negative + per_positive + per_uncertainty",NA,controls5,NA,strat_dvs,NA)
regression_equations5 <- unknown_to_NA(regression_equations5,unknowns_strings)
#Create Independent Variable Equation
for (i in 1:nrow(regression_equations5))
{
temp_char_vec <- c(na.omit(as.character(unlist(regression_equations5[i,1:(ncol(regression_equations5)-1)],use.names=F))))
regression_equations5[i,"full_independent_vars"] <- paste(temp_char_vec,sep="",collapse=" + ")
}
# for (i in 1:ncol(regression_equations5))
# {
#   regression_equations5[i,] <-  gsub("PCT","90",regression_equations5[i,])
#   regression_equations5[i,] <-  gsub("ANYAVG","any",regression_equations5[i,])
#   regression_equations5[i,] <-  gsub("CUTOFF","024",regression_equations5[i,])
# }
for (k in 1:nrow(data_year_groups5))
{
# k <- 1
cat("START YEAR:",data_year_groups5[k,1],"END YEAR:",data_year_groups5[k,2],"\n")
#data_temp <- data_all[(data_all[,"yr"]>=data_year_groups5[k,1] & data_all[,"yr"]<=data_year_groups5[k,2]),]
data_temp <- data_reg[(data_reg[,"yr"]>=data_year_groups5[k,1] & data_reg[,"yr"]<=data_year_groups5[k,2]),]
data_temp.pd <- pdata.frame(data_temp,index=c(identifier,"yr"),drop.index=T,row.names=T)
for (i in 1:length(dep_var5))
{
# i <- 1
for (j in 1:length(sim_type5))
{
# j <- 1
# j <- 2
out_file_name <- paste("reg_compare_plm",dep_var5[i],data_year_groups5[k,1],data_year_groups5[k,2],note5,sim_type5[j],sep="_")
#models <- rep( list(list()),nrow(regression_equations5) )
se <- rep(list(list()),nrow(regression_equations5))
pval <- rep(list(list()),nrow(regression_equations5))
for (l in 1:nrow(regression_equations5))
{
# l <- 1
ind_vars_reg0 <- regression_equations5[l,"full_independent_vars"]
ind_vars_reg0 <- gsub("XXX","ios",ind_vars_reg0,ignore.case=T)
ind_vars_reg0 <- gsub("YYYpct",sim_type5[j],ind_vars_reg0,ignore.case=T)
reg0 <- lm(as.formula(paste(dep_var5[i],ind_vars_reg0,sep="~")),data_temp)
reg0_rse <- coeftest(reg0)
#reg0_rse <- coeftest(reg0,vcov=function(x) vcovHC(x,cluster="group",type="HC1"))
#reg0_rse <- coeftest(reg0,vcov=function(x) vcovDC(x,type="HC1"))
#reg0 <- plm(as.formula(paste(dep_var5[i],ind_vars_reg0,sep="~")),data=data_temp.pd,model=model_type5)
#reg0_rse <- cl.plm(data_temp,reg0,data_temp[,identifier])
#reg0_rse <- mcl.plm(data_temp,reg0,data_temp[,identifier],data_temp[,"yr"])
#reg0_rse <- mcl(data_temp,reg0,data_temp[,identifier],data_temp[,"yr"])
#screenreg(list(reg0),digits=3,model.names=c("(1)"),override.se=list(reg0_rse[,2]),override.pval=list(reg0_rse[,4]),stars=c(0.01,0.05,0.1))
#screenreg(list(reg0),digits=3,model.names=c("(1)"),override.se=list(reg0_rse[,4]),override.pval=list(reg0_rse[,4]),stars=c(0.01,0.05,0.1))
#models[[l]] <- reg0
#se[[l]] <- reg0_rse[,2]
se[[l]] <- reg0_rse[,4]
pval[[l]] <- reg0_rse[,4]
assign(paste("reg",l,sep=""),reg0,envir=.GlobalEnv)
#assign(paste("reg",l,"_rse",sep=""),reg0_rse,envir=.GlobalEnv)
rm2(ind_vars_reg0,reg0,reg0_rse)
}
htmlreg(l=eval(parse(text=paste("list(",paste("reg",seq(1,nrow(regression_equations5)),sep="",collapse=","),")",sep=""))),
model.names=paste("(",seq(1,nrow(regression_equations5)),")",sep=""),override.se=se,override.pval=pval,stars=c(0.01,0.05,0.1),digits=3,
caption="Effect of ???? on Hedge Fund Scores – Multivariate",file=paste(output_dir_reg5,out_file_name,".doc",sep=""))
rm2(se,pval,out_file_name,l)
eval(parse(text=paste("rm(",paste("reg",seq(1,nrow(regression_equations5)),sep="",collapse=","),")",sep="")))
}
rm2(j)
}
rm2(data_temp,data_temp.pd,i)
}
rm2(output_dir_reg5,data_year_groups5,dep_var5,model_type5,note5,sim_type5,controls5,regression_equations5,temp_char_vec,k)
###############################################################################
cat("REGRESSION - PROBIT/LOGIT - SELECTION","\n")
###############################################################################
###############################################################################
cat("REGRESSION - PROBIT/LOGIT - ALL SIM","\n")
###############################################################################
output_dir_reg7 <- paste(output_directory,"reg_all_sim_bin","\\",sep="")
create_directory(output_dir_reg7,remove=1)
data_year_groups7 <- data.frame(matrix(NA,ncol=2,nrow=1,dimnames=list(c(),c("Start_yr","End_yr"))),stringsAsFactors=F)
data_year_groups7[1,] <- c(beg_year,end_year)
#dep_var7 <- unlist(dep_input_bin[,"dep_var"])
dep_var7 <- unlist(dep_input_bin[grep("Revision",dep_input_bin[,"dep_var"]),"dep_var"])
#controls7 <- "age_y + AUM + total_fee + Domicile_onshore_bin + Flagship_bin + Lockup_bin + Leverage_bin + Revision_DV + Sharpe_Ratio "
#controls7 <- "age_y + AUM + total_fee + Domicile_onshore_bin + Flagship_bin + Lockup_bin + Leverage_bin"
#controls7 <- "age_y + AUM + Domicile_onshore_bin + Flagship_bin + Lockup_bin + Leverage_bin"
controls7 <- "age_y_log + AUM_USm_log + Lockup_bin + Hurdle_Rate_bin + Domicile_onshore_bin"
#controls7 <- "age_y + AUM + Lockup_bin + Hurdle_Rate_bin + Domicile_onshore_bin"
#controls7 <- "age_y + AUM + Lockup_bin"
model_type7 <- "pooling"
note7 <- "all_sim"
#sim_type7 <- c("900pct")
#sim_type7 <- c("050pct","900pct")
#sim_type7 <- c("050pct","750pct","900pct")
#sim_type7 <- c("050pct","500pct","750pct","900pct")
sim_type7 <- c("050pct","100pct","250pct","500pct","750pct","900pct")
#read7 <- "avg_grade_level_XXX"
#read7 <- "FOG_XXX"
#read7 <- "Coleman_Liau_XXX"
read7 <- "words_ios"
strat7 <- "all_similarity_YYYpct_XXX"
family7 <- "logit"
#family7 <- "probit"
regression_equations7 <- data.frame(grade=NA,similarity=NA,controls=NA,quantile=NA,fixed_effects=NA,full_independent_vars=NA,stringsAsFactors=F)
regression_equations7[1,] <- c(read7,NA,NA,NA,NA,NA)
regression_equations7[2,] <- c(strat7,NA,NA,NA,NA,NA)
regression_equations7[3,] <- c(paste(read7,strat7,sep=" + "),NA,NA,NA,NA,NA)
regression_equations7[4,] <- c(read7,NA,controls7,NA,NA,NA)
regression_equations7[5,] <- c(strat7,NA,controls7,NA,NA,NA)
regression_equations7[6,] <- c(paste(read7,strat7,sep=" + "),NA,controls7,NA,NA,NA)
regression_equations7[7,] <- c(read7,NA,controls7,NA,strat_dvs,NA)
regression_equations7[8,] <- c(strat7,NA,controls7,NA,strat_dvs,NA)
regression_equations7[9,] <- c(paste(read7,strat7,sep=" + "),NA,controls7,NA,strat_dvs,NA)
for (i in 1:ncol(regression_equations7))
{
#regression_equations7[i,] <-  gsub("PCT","90",regression_equations7[i,])
#regression_equations7[i,] <-  gsub("ANYAVG","any",regression_equations7[i,])
#regression_equations7[i,] <-  gsub("CUTOFF","024",regression_equations7[i,])
regression_equations7[i,] <-  unknown_to_NA(regression_equations7[i,],unknowns_strings)
}
for (i in 1:nrow(regression_equations7))
{
temp_char_vec <- c(na.omit(as.character(unlist(regression_equations7[i,1:(ncol(regression_equations7)-1)],use.names=F))))
regression_equations7[i,"full_independent_vars"] <- paste(temp_char_vec,sep="",collapse=" + ")
}
for (k in 1:nrow(data_year_groups7))
{
# k <- 1
cat("START YEAR:",data_year_groups7[k,1],"END YEAR:",data_year_groups7[k,2],"\n")
data_temp <- data_reg[(data_reg[,"yr"]>=data_year_groups7[k,1] & data_reg[,"yr"]<=data_year_groups7[k,2]),]
for (i in 1:length(dep_var7))
{
# i <- 1
for (j in 1:length(sim_type7))
{
# j <- 1
# j <- 2
out_file_name <- paste("reg_compare_plm",dep_var7[i],data_year_groups7[k,1],data_year_groups7[k,2],note7,sim_type7[j],sep="_")
#models <- rep( list(list()),nrow(regression_equations7) )
se <- rep(list(list()),nrow(regression_equations7))
pval <- rep(list(list()),nrow(regression_equations7))
for (l in 1:nrow(regression_equations7))
{
# l <- 1
ind_vars_reg0 <- regression_equations7[l,"full_independent_vars"]
ind_vars_reg0 <- gsub("XXX","ios",ind_vars_reg0,ignore.case=T)
ind_vars_reg0 <- gsub("YYYpct",sim_type7[j],ind_vars_reg0,ignore.case=T)
reg0 <- glm(as.formula(paste(dep_var7[i],ind_vars_reg0,sep="~")),family=binomial(link=family7),data=data_temp)
reg0_rse <- coeftest(reg0)
#reg0_rse <- coeftest(reg0,vcov=function(x) vcovHC(x,cluster="group",type="HC1"))
#reg0_rse <- coeftest(reg0,vcov=function(x) vcovDC(x,type="HC1"))
#reg0 <- plm(as.formula(paste(dep_var7[i],ind_vars_reg0,sep="~")),data=data_temp.pd,model=model_type7)
#reg0_rse <- cl.plm(data_temp,reg0,data_temp[,identifier])
#reg0_rse <- mcl.plm(data_temp,reg0,data_temp[,identifier],data_temp[,"yr"])
#reg0_rse <- mcl(data_temp,reg0,data_temp[,identifier],data_temp[,"yr"])
#screenreg(list(reg0),digits=3,model.names=c("(1)"),override.se=list(reg0_rse[,2]),override.pval=list(reg0_rse[,4]),stars=c(0.01,0.05,0.1))
#screenreg(list(reg0),digits=3,model.names=c("(1)"),override.se=list(reg0_rse[,4]),override.pval=list(reg0_rse[,4]),stars=c(0.01,0.05,0.1))
#models[[l]] <- reg0
#se[[l]] <- reg0_rse[,2]
se[[l]] <- reg0_rse[,4]
pval[[l]] <- reg0_rse[,4]
assign(paste("reg",l,sep=""),reg0,envir=.GlobalEnv)
#assign(paste("reg",l,"_rse",sep=""),reg0_rse,envir=.GlobalEnv)
rm2(ind_vars_reg0,reg0,reg0_rse)
}
htmlreg(l=eval(parse(text=paste("list(",paste("reg",seq(1,nrow(regression_equations7)),sep="",collapse=","),")",sep=""))),
model.names=paste("(",seq(1,nrow(regression_equations7)),")",sep=""),override.se=se,override.pval=pval,stars=c(0.01,0.05,0.1),digits=3,
caption="Effect of ???? on Hedge Fund Scores – Multivariate",file=paste(output_dir_reg7,out_file_name,".doc",sep=""))
rm2(se,pval,out_file_name,l)
eval(parse(text=paste("rm(",paste("reg",seq(1,nrow(regression_equations7)),sep="",collapse=","),")",sep="")))
}
rm2(j)
}
rm2(data_temp,i)
}
rm2(output_dir_reg7,data_year_groups7,dep_var7,model_type7,note7,sim_type7,controls7,read7,strat7,family7,regression_equations7,temp_char_vec,k)
###############################################################################
cat("REGRESSION - PROBIT/LOGIT - CAT SIM","\n")
###############################################################################
output_dir_reg8 <- paste(output_directory,"reg_cat_sim_bin","\\",sep="")
create_directory(output_dir_reg8,remove=1)
data_year_groups8 <- data.frame(matrix(NA,ncol=2,nrow=1,dimnames=list(c(),c("Start_yr","End_yr"))),stringsAsFactors=F)
data_year_groups8[1,] <- c(beg_year,end_year)
#dep_var8 <- unlist(dep_input_bin[,"dep_var"])
dep_var8 <- unlist(dep_input_bin[grep("Revision",dep_input_bin[,"dep_var"]),"dep_var"])
#controls8 <- "age_y + AUM + total_fee + Domicile_onshore_bin + Flagship_bin + Lockup_bin + Leverage_bin + Revision_DV + Sharpe_Ratio "
#controls8 <- "age_y + AUM + total_fee + Domicile_onshore_bin + Flagship_bin + Lockup_bin + Leverage_bin"
#controls8 <- "age_y + AUM + Domicile_onshore_bin + Flagship_bin + Lockup_bin + Leverage_bin"
controls8 <- "age_y_log + AUM_USm_log + Lockup_bin + Hurdle_Rate_bin + Domicile_onshore_bin"
#controls8 <- "age_y + AUM + Lockup_bin + Hurdle_Rate_bin + Domicile_onshore_bin"
#controls8 <- "age_y + AUM + Lockup_bin"
model_type8 <- "pooling"
note8 <- "cat_sim"
#sim_type8 <- c("900pct")
#sim_type8 <- c("050pct","900pct")
#sim_type8 <- c("050pct","750pct","900pct")
#sim_type8 <- c("050pct","500pct","750pct","900pct")
sim_type8 <- c("050pct","100pct","250pct","500pct","750pct","900pct")
#read8 <- "avg_grade_level_XXX"
#read8 <- "FOG_XXX"
#read8 <- "Coleman_Liau_XXX"
read8 <- "words_ios"
strat8 <- "Primary_Investment_Strategy_combcol_similarity_YYYpct_XXX"
family8 <- "logit"
#family8 <- "probit"
regression_equations8 <- data.frame(grade=NA,similarity=NA,controls=NA,quantile=NA,fixed_effects=NA,full_independent_vars=NA,stringsAsFactors=F)
regression_equations8[1,] <- c(read8,NA,NA,NA,NA,NA)
regression_equations8[2,] <- c(strat8,NA,NA,NA,NA,NA)
regression_equations8[3,] <- c(paste(read8,strat8,sep=" + "),NA,NA,NA,NA,NA)
regression_equations8[4,] <- c(read8,NA,controls8,NA,NA,NA)
regression_equations8[5,] <- c(strat8,NA,controls8,NA,NA,NA)
regression_equations8[6,] <- c(paste(read8,strat8,sep=" + "),NA,controls8,NA,NA,NA)
regression_equations8[7,] <- c(read8,NA,controls8,NA,strat_dvs,NA)
regression_equations8[8,] <- c(strat8,NA,controls8,NA,strat_dvs,NA)
regression_equations8[9,] <- c(paste(read8,strat8,sep=" + "),NA,controls8,NA,strat_dvs,NA)
for (i in 1:ncol(regression_equations8))
{
#regression_equations8[i,] <-  gsub("PCT","90",regression_equations8[i,])
#regression_equations8[i,] <-  gsub("ANYAVG","any",regression_equations8[i,])
#regression_equations8[i,] <-  gsub("CUTOFF","024",regression_equations8[i,])
regression_equations8[i,] <-  unknown_to_NA(regression_equations8[i,],unknowns_strings)
}
for (i in 1:nrow(regression_equations8))
{
temp_char_vec <- c(na.omit(as.character(unlist(regression_equations8[i,1:(ncol(regression_equations8)-1)],use.names=F))))
regression_equations8[i,"full_independent_vars"] <- paste(temp_char_vec,sep="",collapse=" + ")
}
for (k in 1:nrow(data_year_groups8))
{
# k <- 1
cat("START YEAR:",data_year_groups8[k,1],"END YEAR:",data_year_groups8[k,2],"\n")
data_temp <- data_reg[(data_reg[,"yr"]>=data_year_groups8[k,1] & data_reg[,"yr"]<=data_year_groups8[k,2]),]
for (i in 1:length(dep_var8))
{
# i <- 1
for (j in 1:length(sim_type8))
{
# j <- 1
# j <- 2
out_file_name <- paste("reg_compare_plm",dep_var8[i],data_year_groups8[k,1],data_year_groups8[k,2],note8,sim_type8[j],sep="_")
#models <- rep( list(list()),nrow(regression_equations8) )
se <- rep(list(list()),nrow(regression_equations8))
pval <- rep(list(list()),nrow(regression_equations8))
for (l in 1:nrow(regression_equations8))
{
# l <- 1
ind_vars_reg0 <- regression_equations8[l,"full_independent_vars"]
ind_vars_reg0 <- gsub("XXX","ios",ind_vars_reg0,ignore.case=T)
ind_vars_reg0 <- gsub("YYYpct",sim_type8[j],ind_vars_reg0,ignore.case=T)
reg0 <- glm(as.formula(paste(dep_var8[i],ind_vars_reg0,sep="~")),family=binomial(link=family8),data=data_temp)
reg0_rse <- coeftest(reg0)
#reg0_rse <- coeftest(reg0,vcov=function(x) vcovHC(x,cluster="group",type="HC1"))
#reg0_rse <- coeftest(reg0,vcov=function(x) vcovDC(x,type="HC1"))
#reg0 <- plm(as.formula(paste(dep_var8[i],ind_vars_reg0,sep="~")),data=data_temp.pd,model=model_type8)
#reg0_rse <- cl.plm(data_temp,reg0,data_temp[,identifier])
#reg0_rse <- mcl.plm(data_temp,reg0,data_temp[,identifier],data_temp[,"yr"])
#reg0_rse <- mcl(data_temp,reg0,data_temp[,identifier],data_temp[,"yr"])
#screenreg(list(reg0),digits=3,model.names=c("(1)"),override.se=list(reg0_rse[,2]),override.pval=list(reg0_rse[,4]),stars=c(0.01,0.05,0.1))
#screenreg(list(reg0),digits=3,model.names=c("(1)"),override.se=list(reg0_rse[,4]),override.pval=list(reg0_rse[,4]),stars=c(0.01,0.05,0.1))
#models[[l]] <- reg0
#se[[l]] <- reg0_rse[,2]
se[[l]] <- reg0_rse[,4]
pval[[l]] <- reg0_rse[,4]
assign(paste("reg",l,sep=""),reg0,envir=.GlobalEnv)
#assign(paste("reg",l,"_rse",sep=""),reg0_rse,envir=.GlobalEnv)
rm2(ind_vars_reg0,reg0,reg0_rse)
}
htmlreg(l=eval(parse(text=paste("list(",paste("reg",seq(1,nrow(regression_equations8)),sep="",collapse=","),")",sep=""))),
model.names=paste("(",seq(1,nrow(regression_equations8)),")",sep=""),override.se=se,override.pval=pval,stars=c(0.01,0.05,0.1),digits=3,
caption="Effect of ???? on Hedge Fund Scores – Multivariate",file=paste(output_dir_reg8,out_file_name,".doc",sep=""))
rm2(se,pval,out_file_name,l)
eval(parse(text=paste("rm(",paste("reg",seq(1,nrow(regression_equations8)),sep="",collapse=","),")",sep="")))
}
rm2(j)
}
rm2(data_temp,i)
}
rm2(output_dir_reg8,data_year_groups8,dep_var8,model_type8,note8,sim_type8,controls8,read8,strat8,family8,regression_equations8,temp_char_vec,k)
###############################################################################
cat("REGRESSION - PROBIT/LOGIT - TONE","\n")
###############################################################################
output_dir_reg9 <- paste(output_directory,"reg_tone_bin","\\",sep="")
create_directory(output_dir_reg9,remove=1)
data_year_groups9 <- data.frame(matrix(NA,ncol=2,nrow=1,dimnames=list(c(),c("Start_yr","End_yr"))),stringsAsFactors=F)
data_year_groups9[1,] <- c(beg_year,end_year)
#dep_var9 <- unlist(dep_input_bin[,"dep_var"])
dep_var9 <- unlist(dep_input_bin[grep("Revision",dep_input_bin[,"dep_var"]),"dep_var"])
#controls9 <- "age_y + AUM + total_fee + Domicile_onshore_bin + Flagship_bin + Lockup_bin + Leverage_bin + Revision_DV + Sharpe_Ratio "
#controls9 <- "age_y + AUM + total_fee + Domicile_onshore_bin + Flagship_bin + Lockup_bin + Leverage_bin"
#controls9 <- "age_y + AUM + Domicile_onshore_bin + Flagship_bin + Lockup_bin + Leverage_bin"
controls9 <- "age_y_log + AUM_USm_log + Lockup_bin + Hurdle_Rate_bin + Domicile_onshore_bin"
#controls9 <- "age_y + AUM + Lockup_bin + Hurdle_Rate_bin + Domicile_onshore_bin"
#controls9 <- "age_y + AUM + Lockup_bin"
model_type9 <- "pooling"
note9 <- "tone"
#sim_type9 <- c("900pct")
#sim_type9 <- c("050pct","900pct")
#sim_type9 <- c("050pct","750pct","900pct")
#sim_type9 <- c("050pct","500pct","750pct","900pct")
sim_type9 <- c("050pct","100pct","250pct","500pct","750pct","900pct")
family9 <- "logit"
#family9 <- "probit"
regression_equations9 <- data.frame(grade=NA,similarity=NA,controls=NA,quantile=NA,fixed_effects=NA,full_independent_vars=NA,stringsAsFactors=F)
# regression_equations9[1,] <- c("per_litigious",NA,controls9,NA,NA,NA)
# regression_equations9[2,] <- c("per_modalstrong",NA,controls9,NA,NA,NA)
# regression_equations9[3,] <- c("per_modalweak",NA,controls9,NA,NA,NA)
# regression_equations9[4,] <- c("per_negative",NA,controls9,NA,NA,NA)
# regression_equations9[5,] <- c("per_positive",NA,controls9,NA,NA,NA)
# regression_equations9[6,] <- c("per_uncertainty",NA,controls9,NA,NA,NA)
# regression_equations9[7,] <- c("per_litigious + per_modalstrong + per_modalweak + per_negative + per_positive + per_uncertainty",NA,controls9,NA,NA,NA)
# regression_equations9[8,] <- c("per_litigious + per_modalstrong + per_modalweak + per_negative + per_positive + per_uncertainty",NA,controls9,NA,strat_dvs,NA)
regression_equations9[1,] <- c("per_litigious",NA,NA,NA,NA,NA)
regression_equations9[2,] <- c("per_negative",NA,NA,NA,NA,NA)
regression_equations9[3,] <- c("per_positive",NA,NA,NA,NA,NA)
regression_equations9[4,] <- c("per_uncertainty",NA,NA,NA,NA,NA)
regression_equations9[5,] <- c("per_litigious",NA,controls9,NA,NA,NA)
regression_equations9[6,] <- c("per_negative",NA,controls9,NA,NA,NA)
regression_equations9[7,] <- c("per_positive",NA,controls9,NA,NA,NA)
regression_equations9[8,] <- c("per_uncertainty",NA,controls9,NA,NA,NA)
regression_equations9[9,] <- c("per_litigious + per_negative + per_positive + per_uncertainty",NA,controls9,NA,NA,NA)
regression_equations9[10,] <- c("per_litigious + per_negative + per_positive + per_uncertainty",NA,controls9,NA,strat_dvs,NA)
regression_equations9 <- unknown_to_NA(regression_equations9,unknowns_strings)
#Create Independent Variable Equation
for (i in 1:nrow(regression_equations9))
{
temp_char_vec <- c(na.omit(as.character(unlist(regression_equations9[i,1:(ncol(regression_equations9)-1)],use.names=F))))
regression_equations9[i,"full_independent_vars"] <- paste(temp_char_vec,sep="",collapse=" + ")
}
# for (i in 1:ncol(regression_equations9))
# {
#   regression_equations9[i,] <-  gsub("PCT","90",regression_equations9[i,])
#   regression_equations9[i,] <-  gsub("ANYAVG","any",regression_equations9[i,])
#   regression_equations9[i,] <-  gsub("CUTOFF","024",regression_equations9[i,])
# }
for (k in 1:nrow(data_year_groups9))
{
# k <- 1
cat("START YEAR:",data_year_groups9[k,1],"END YEAR:",data_year_groups9[k,2],"\n")
data_temp <- data_reg[(data_reg[,"yr"]>=data_year_groups9[k,1] & data_reg[,"yr"]<=data_year_groups9[k,2]),]
for (i in 1:length(dep_var9))
{
# i <- 1
for (j in 1:length(sim_type9))
{
# j <- 1
# j <- 2
out_file_name <- paste("reg_compare_plm",dep_var9[i],data_year_groups9[k,1],data_year_groups9[k,2],note9,sim_type9[j],sep="_")
#models <- rep( list(list()),nrow(regression_equations9) )
se <- rep(list(list()),nrow(regression_equations9))
pval <- rep(list(list()),nrow(regression_equations9))
for (l in 1:nrow(regression_equations9))
{
# l <- 1
ind_vars_reg0 <- regression_equations9[l,"full_independent_vars"]
ind_vars_reg0 <- gsub("XXX","ios",ind_vars_reg0,ignore.case=T)
ind_vars_reg0 <- gsub("YYYpct",sim_type9[j],ind_vars_reg0,ignore.case=T)
reg0 <- glm(as.formula(paste(dep_var9[i],ind_vars_reg0,sep="~")),family=binomial(link=family9),data=data_temp)
reg0_rse <- coeftest(reg0)
#reg0_rse <- coeftest(reg0,vcov=function(x) vcovHC(x,cluster="group",type="HC1"))
#reg0_rse <- coeftest(reg0,vcov=function(x) vcovDC(x,type="HC1"))
#reg0 <- plm(as.formula(paste(dep_var9[i],ind_vars_reg0,sep="~")),data=data_temp.pd,model=model_type9)
#reg0_rse <- cl.plm(data_temp,reg0,data_temp[,identifier])
#reg0_rse <- mcl.plm(data_temp,reg0,data_temp[,identifier],data_temp[,"yr"])
#reg0_rse <- mcl(data_temp,reg0,data_temp[,identifier],data_temp[,"yr"])
#screenreg(list(reg0),digits=3,model.names=c("(1)"),override.se=list(reg0_rse[,2]),override.pval=list(reg0_rse[,4]),stars=c(0.01,0.05,0.1))
#screenreg(list(reg0),digits=3,model.names=c("(1)"),override.se=list(reg0_rse[,4]),override.pval=list(reg0_rse[,4]),stars=c(0.01,0.05,0.1))
#models[[l]] <- reg0
#se[[l]] <- reg0_rse[,2]
se[[l]] <- reg0_rse[,4]
pval[[l]] <- reg0_rse[,4]
assign(paste("reg",l,sep=""),reg0,envir=.GlobalEnv)
#assign(paste("reg",l,"_rse",sep=""),reg0_rse,envir=.GlobalEnv)
rm2(ind_vars_reg0,reg0,reg0_rse)
}
htmlreg(l=eval(parse(text=paste("list(",paste("reg",seq(1,nrow(regression_equations9)),sep="",collapse=","),")",sep=""))),
model.names=paste("(",seq(1,nrow(regression_equations9)),")",sep=""),override.se=se,override.pval=pval,stars=c(0.01,0.05,0.1),digits=3,
caption="Effect of ???? on Hedge Fund Scores – Multivariate",file=paste(output_dir_reg9,out_file_name,".doc",sep=""))
rm2(se,pval,out_file_name,l)
eval(parse(text=paste("rm(",paste("reg",seq(1,nrow(regression_equations9)),sep="",collapse=","),")",sep="")))
}
rm2(j)
}
rm2(data_temp,i)
}
rm2(output_dir_reg9,data_year_groups9,dep_var9,model_type9,note9,sim_type9,controls9,family9,regression_equations9,temp_char_vec,k)
